{% extends "base.html" %}
{% block title %}OZfoody - Inbox{% endblock %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/inbox.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/general_styles.css') }}"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/alert.css') }}">
{% endblock %}

{% block content %}
<div class="inbox-container">
<h2>
    Inbox
    {% if unseen_count and unseen_count > 0 %}
        <span class="badge bg-danger" style="font-size:1rem;vertical-align:top;">
            {{ unseen_count }}
        </span>
    {% endif %}
</h2>

<!-- Incoming follow requests -->
{% if incoming_requests %}
    <h4>Follow Requests</h4>
    <ul class="list-group mb-4">
    {% for req in incoming_requests %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
            <span>
                <strong>{{ req.follower.username }}</strong> wants to follow you.
            </span>
            <span>
                <button class="btn btn-primary btn-sm approve-follow-btn" data-id="{{ req.id }}">Approve</button>
                <button class="btn btn-danger btn-sm reject-follow-btn" data-id="{{ req.id }}">Reject</button>
            </span>
        </li>
    {% endfor %}
    </ul>
{% endif %}

{% if posts %}
    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4">
    {% for item in posts %}
        <div class="card-header">
            {% set review = item.note %}
            {% set current_user = user %}
            {% include "post.html" %}
        </div>
    {% endfor %}
    </div>
{% else %}
    <p>No shared posts yet.</p>
{% endif %}
</div>
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='JS/inbox.js') }}"></script>
{% endblock %}