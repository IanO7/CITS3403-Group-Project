{% extends "base.html" %}
{% block title %} Profile {% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/general_styles.css') }}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/badge.css') }}">

<div id="profileHeader" class="container mt-2">
    {% if user.profileImage %}
    <img src="{{ url_for('views.uploaded_file', filename=user.profileImage) }}" class="profileImage" alt="profile image"> 
    {% endif %} 
</div>

<div id="profileSub" class="container mt-1">
    <h1>
        {{ user.username }}
        <!-- Show the badge next to the username -->
        <span class="badge badge-level level-{{ level }}">Level {{ level }}</span>
    </h1>
    <button class="addPost" onclick="location.href='/new_post'">Add âž• </button>

</div>

<div class="mb-3">
    <button class="btn btn-success" id="shareMultipleBtn">Share Multiple ðŸ”—</button>
    <button class="btn btn-primary d-none" id="shareSelectedBtn" style="margin-left:10px;">Share Selected</button>
</div>


<div id="multiShareAlert" class="alert alert-success d-none" role="alert"></div>
<div id="singleShareAlert" class="alert alert-success d-none" role="alert"></div>

<style>
    .addPost {
    display: inline-block;
    padding: 8px 16px;
    font-size: 1rem;
    font-weight: 600;
    background-color: #007BFF;
    color: white;
    border: none;
    border-radius: 10px;
    text-align: center;
    text-decoration: none;
    white-space: nowrap;
    transition: background-color 0.3s ease;
    width: auto;
}

.addPost:hover {
    background-color: #0056b3;
    cursor: pointer;
}

    .profileImage {
        width: 120px;
        height: 120px;
        object-fit: cover;
        border-radius: 50%;
        border: 2px solid #fff;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    /* Post Styles */
    .card-body {
        padding: 15px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }
    .post-image {
        width: 100%;

        height: 250px;

        object-fit: cover;
        border-radius: 10px;
        margin-top: 15px;
    }

    .reaction-buttons {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: auto;
    }

    .reaction-buttons button {
        width: 22%;
        padding: 8px;
        border-radius: 25px;
        font-size: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .reaction-buttons .btn {
        border-radius: 25px;
        transition: background-color 0.3s;
    }

    .reaction-buttons .btn:hover {
        background-color: #f0f0f0;
    }

    .reaction-buttons .like-button i,
    .reaction-buttons .comment-button i,
    .reaction-buttons .share-button i,
    .reaction-buttons .delete-button i {
        margin-right: 5px;
    }

    /* Hide multi-share checkboxes by default */
    .multi-share-checkbox {
        display: none;
    }
    .multi-share-mode .multi-share-checkbox {
        display: block;
    }
    
</style>
{% if reviews %}
<div id="userPosts">
    <div id="Posts" class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4">
        {% for review in reviews %}
            {% include "post.html" %}
        {% endfor %}
    </div>
</div>
{% else %}
    <p class="text-muted text-center mt-5">You haven't posted any reviews yet.</p>
{% endif %}

<div class="modal" tabindex="-1" id="shareModal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Share Post</h5>
        <button type="button" class="btn-close" onclick="closeShareModal()"></button>
      </div>
      <div class="modal-body">
        <label for="recipientSearch">Search user to share with:</label>
        <input type="text" id="recipientSearch" class="form-control" autocomplete="off" placeholder="Type username...">
        <div id="userResults" class="list-group" style="max-height:150px;overflow-y:auto;"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closeShareModal()">Cancel</button>
        <button type="button" class="btn btn-primary" id="confirmShareBtn">Share</button>
      </div>
    </div>
  </div>
</div>

<div class="modal" tabindex="-1" id="multiShareModal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Share Selected Posts</h5>
        <button type="button" class="btn-close" onclick="closeMultiShareModal()"></button>
      </div>
      <div class="modal-body">
        <label for="multiRecipientSearch">Search user to share with:</label>
        <input type="text" id="multiRecipientSearch" class="form-control" autocomplete="off" placeholder="Type username...">
        <div id="multiUserResults" class="list-group" style="max-height:150px;overflow-y:auto;"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closeMultiShareModal()">Cancel</button>
        <button type="button" class="btn btn-primary" id="confirmMultiShareBtn">Share</button>
      </div>
    </div>
  </div>
</div>


<script src="{{ url_for('static', filename='JS/profile.js') }}"></script>
{% endblock %}