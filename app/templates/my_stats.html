{% extends "base.html" %}
{% block title %}My Stats Dashboard{% endblock %}

{% block content %}
    <!-- Floating Navbar is handled by base.html -->

    <div class="container-fluid">
        <!-- Profile Card -->
        <div class="card profile-card mb-4">
            <div class="row g-0 align-items-center">
                <div class="col-md-4 text-center">
                    <img src="{{ url_for('static', filename='Images/profile-placeholder.png') }}"
                         alt="Profile Picture"
                         class="profile-img">
                </div>
                <div class="col-md-8">
                    <div class="card-body">
                        <h1 class="card-title">
                          Welcome back, <span class="user-name">{{ user.username }}</span>
                        </h1>
                        <p class="card-text">Here’s a summary of your food journey so far!</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Personal Food Statistics -->
        <div class="container-fluid">
            <h3 class="section-title">Your Taste:</h3>
            <div class="row">
                <div class="col-md-6 mb-4">
                    <div class="taste-card">
                        <p class="taste-title">🌶️ Spiciness</p>
                        <div class="progress custom-progress">
                            <div class="progress-bar bg-danger"
                                 role="progressbar"
                                 style="width: {{ stats.spiciness | default(0) }}%;"
                                 aria-valuenow="{{ stats.spiciness }}"
                                 aria-valuemin="0"
                                 aria-valuemax="100"></div>
                            <span class="progress-emoji"
                                  style="left: {{ stats.spiciness }}%;">🌶️</span>
                        </div>
                    </div>
                </div>

    <!-- Statistics Section -->
    <div class="stats-grid">
        <!-- Taste Stats -->
        <div class="card stat-card">
            <h3 class="card-title">🌶️ Spiciness</h3>
            <div class="progress custom-progress">
                <div class="progress-bar bg-danger" style="width: {{ stats.spiciness | default(0) }}%;"></div>
            </div>
            <p>{{ stats.spiciness | default(0) }}% spicy dishes rated</p>
        </div>

        <div class="card stat-card">
            <h3 class="card-title">🤤 Deliciousness</h3>
            <div class="progress custom-progress">
                <div class="progress-bar bg-success" style="width: {{ stats.deliciousness | default(0) }}%;"></div>
            </div>
            <p>{{ stats.deliciousness | default(0) }}% delicious dishes rated</p>
        </div>

        <div class="card stat-card">
            <h3 class="card-title">💰 Value</h3>
            <div class="progress custom-progress">
                <div class="progress-bar bg-warning" style="width: {{ stats.value | default(0) }}%;"></div>
            </div>
            <p>{{ stats.value | default(0) }}% value-rated dishes</p>
        </div>

        <div class="card stat-card">
            <h3 class="card-title">🍽️ Plating</h3>
            <div class="progress custom-progress">
                <div class="progress-bar bg-info" style="width: {{ stats.plating | default(0) }}%;"></div>
            </div>
            <p>{{ stats.plating | default(0) }}% plating-rated dishes</p>
        </div>
    </div>

    <!-- Charts Section -->
    <div class="charts-grid">
        <div class="card chart-card">
            <h3 class="card-title">🍴 Food Eaten/Reviewed</h3>
            <canvas id="foodChart"></canvas>
        </div>
        <div class="card chart-card">
            <h3 class="card-title">🌍 Favorite Cuisine</h3>
            <canvas id="cuisineChart"></canvas>
        </div>
        <div class="card chart-card">
            <h3 class="card-title">⭐ Average Rating</h3>
            <canvas id="ratingChart"></canvas>
        </div>
    </div>

    <!-- Achievements Section -->
    <div class="achievements-section">
        <h2>Achievements & Badges</h2>
        <div class="badges-grid">
            <div class="badge-card">
                <img src="{{ url_for('static', filename='Image Sources/chilli-master.png') }}" alt="Spice Master Badge">
                <p>Spice Master</p>
            </div>
            <div class="badge-card">
                <img src="{{ url_for('static', filename='Image Sources/plating-perfectionist.png') }}" alt="Plating Perfectionist Badge">
                <p>Plating Perfectionist</p>
            </div>
            <div class="badge-card">
                <img src="{{ url_for('static', filename='Image Sources/deliciousness-guru.png') }}" alt="Deliciousness Guru Badge">
                <p>Deliciousness Guru</p>
            </div>
            <div class="badge-card">
                <img src="{{ url_for('static', filename='Image Sources/value-hunter.png') }}" alt="Value Hunter Badge">
                <p>Value Hunter</p>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Example Chart.js setup
    const foodChartCtx = document.getElementById('foodChart').getContext('2d');
    const foodChart = new Chart(foodChartCtx, {
        type: 'doughnut',
        data: {
            labels: ['Spicy', 'Delicious', 'Value', 'Plating'],
            datasets: [{
                data: [{{ stats.spiciness }}, {{ stats.deliciousness }}, {{ stats.value }}, {{ stats.plating }}],
                backgroundColor: ['#DF6F1B', '#5F8D3B', '#8E5F2B', '#6E3A14']
            }]
        }
    });

    // Add similar setups for cuisineChart and ratingChart
</script>
{% endblock %}
